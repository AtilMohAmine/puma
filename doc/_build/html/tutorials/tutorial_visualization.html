

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial: 3D Visualization &mdash; PuMA 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorial: Weaves" href="tutorial_weaves.html" />
    <link rel="prev" title="Tutorial: Continuum Tortuosity" href="tutorial_tortuosity_continuum.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/puma_logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">C++ library:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../readme.html">PuMA_V3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../help.html">Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
<p class="caption"><span class="caption-text">Python Package:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../files/modules.html">pumapy</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_datastructures.html">Tutorial: Data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_elasticity.html">Tutorial: Elasticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_generate_random_fibers.html">Tutorial: Generating Random Fiber Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_generate_random_spheres.html">Tutorial: Generating Random Sphere Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_generate_tpms.html">Tutorial: Generating Triply Periodic Minimal Surfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_import_export.html">Tutorial: import and export</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_multi_phase.html">Tutorial: Multi-phase material</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_permeability.html">Tutorial: Permeability</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_STL.html">Tutorial: STL generation and output</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_surface_area.html">Tutorial: Calculating Surface Area</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_thermalconductivity.html">Tutorial: Thermal Conductivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_tortuosity_continuum.html">Tutorial: Continuum Tortuosity</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial: 3D Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_weaves.html">Tutorial: Weaves</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PuMA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Tutorial: 3D Visualization</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/tutorial_visualization.nblink.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Tutorial:-3D-Visualization">
<h1>Tutorial: 3D Visualization<a class="headerlink" href="#Tutorial:-3D-Visualization" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial we demonstrate the use of the 3D Visualization capabilities in pumapy. The 3D visualization is based on a coupling with paraview and VTK. Visualization can be performed on either raw tomography samples (each material phase is composed of a range of grayscale values) or segmented images (each material phase is a single grayscale value). Pumapy can currently produce volume renderings or contours. Examples of each visualization are shown below.</p>
<p>First, we must import puma:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Note - &quot;conda activate pumapy&quot; must be run prior to calling pumapy</span>
<span class="kn">import</span> <span class="nn">pumapy</span> <span class="k">as</span> <span class="nn">puma</span>

<span class="c1"># Note - the first time puma is run on a machine, the import command will take a couple minutes as the cython code has to be compiled</span>
</pre></div>
</div>
</div>
<p>Next we must either import or generate a material to visualize. Computational domains are stored in the workspace class. Below we show an example of both importing and computationally generating a material:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Generating a workspace of randomly placed, intersecting sphers:</span>
<span class="c1">#.    size of domain in voxels: (200,200,200)</span>
<span class="c1">#.    diameter of each sphere in voxels: 20</span>
<span class="c1">#.    porosity of generated material: 0.7</span>
<span class="n">ws_generated</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">generate_random_spheres</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># The voxel length (in meters) of the workspace defaults to 1 micron (1e-6 m).</span>
<span class="c1"># To change the voxel length, modify the parameter directly:</span>
<span class="n">ws_generated</span><span class="o">.</span><span class="n">voxel_length</span> <span class="o">=</span> <span class="mf">1.3e-6</span>

<span class="c1"># Next we will import an example tomography file of size 200^3 and voxel length 1.3e-6</span>
<span class="n">ws_imported</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">import_3Dtiff</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PuMA_DIR&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/python/tests/testdata/200_FiberForm.tif&quot;</span><span class="p">,</span> <span class="mf">1.3e-6</span><span class="p">)</span>

</pre></div>
</div>
</div>
<p>The workspaces above have not been segmented yet. In the case of generated workspace, the generated material has been stored for a grayscale [128,255] and the void phase is stored between [0,127]. The appropriate grayscale cutoff for the imported tomography sample is 90, such that [90,255] is material and [0,89] is the void. These values will be different for each tomography image.</p>
<p>First, we will generate both volume and contour renderings of the two materials without segmentation. By default, the contour triangles are a solid color. If you would prefer the colors to be weighted by the local grayscale value, the color option can be set to true in the visualization:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Generating Volume and Contour renderings of the computationally generated material</span>
<span class="c1">#    The grayscale range of the material to be rendered is specified as (128,255) and is inclusive</span>
<span class="n">puma</span><span class="o">.</span><span class="n">render_contour</span><span class="p">(</span><span class="n">ws_generated</span><span class="p">,</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>
<span class="n">puma</span><span class="o">.</span><span class="n">render_contour</span><span class="p">(</span><span class="n">ws_imported</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>

<span class="n">puma</span><span class="o">.</span><span class="n">render_volume</span><span class="p">(</span><span class="n">ws_generated</span><span class="p">,</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>
<span class="n">puma</span><span class="o">.</span><span class="n">render_volume</span><span class="p">(</span><span class="n">ws_imported</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>

<span class="c1"># Note - there is a bug with VTK and MacOS where the 3D volume is sometimes unresponsive when first opened.</span>
<span class="c1"># If this occurs, minimize and then expand the window, and it should work properly</span>
</pre></div>
</div>
</div>
<p>Next, we will segment the workspaces, such that all void voxels contain an ID of 0 and all solid voxels contain an ID of 1. This could be expanded for multi-phase domains.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Setting all grayscale values between 0 and 127, inclusive, to 0</span>
<span class="n">ws_generated</span><span class="o">.</span><span class="n">set_material_id</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">127</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># Setting all grayscale values between 128 and 255, inclusive, to 1</span>
<span class="n">ws_generated</span><span class="o">.</span><span class="n">set_material_id</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Setting all grayscale values between 0 and 89 to 0. This represents the void phase in the tomography file</span>
<span class="n">ws_imported</span><span class="o">.</span><span class="n">set_material_id</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">89</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># Setting all grayscale values between 90 and 255 to 1. This represents the solid phase in the tomography file</span>
<span class="n">ws_imported</span><span class="o">.</span><span class="n">set_material_id</span><span class="p">((</span><span class="mi">90</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>

</pre></div>
</div>
</div>
<p>Now we will generate contour and volume renderings of the segmented files. Note that the grayscale values have changed. In the case of the contour render, the new grayscale values can be specified by either setting the appropriate range - (1,1) in this case, or by specifying the material ID value itself - 1 in this case. For the volume render, the range of grayscales to be considered must be included, in this case simply (1,1)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">puma</span><span class="o">.</span><span class="n">render_contour</span><span class="p">(</span><span class="n">ws_generated</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">puma</span><span class="o">.</span><span class="n">render_contour</span><span class="p">(</span><span class="n">ws_imported</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">puma</span><span class="o">.</span><span class="n">render_volume</span><span class="p">(</span><span class="n">ws_generated</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">puma</span><span class="o">.</span><span class="n">render_volume</span><span class="p">(</span><span class="n">ws_imported</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Note that the contour renders for the segmented images are significantly less smooth than for the non-segmented images. This is because for segmented images, the triangulation algorithms have significantly less degrees of freedom when assigning triangle angles, resulting in a rougher surface than for non-segmented images.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial_weaves.html" class="btn btn-neutral float-right" title="Tutorial: Weaves" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorial_tortuosity_continuum.html" class="btn btn-neutral float-left" title="Tutorial: Continuum Tortuosity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, PuMA Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>